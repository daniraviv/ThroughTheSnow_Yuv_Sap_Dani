@page "/"
@inject HttpClient Http

@inject NavigationManager nav
<h3 id="tgfg">Login</h3>

<MudTextField @bind-Value="inputMail" Label="Outlined" Variant="Variant.Outlined" Margin="Margin.Dense"></MudTextField>
<MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="loginUser">כניסה</MudButton>
<p>@msg</p>

@code
 { string inputMail = "";


    string msg = "";

    async Task loginUser()
    {

        // תנאי שבודק האם המשתמש הזין מייל
        // IsNullOrEmptyכשרוצים להשתמש ב
        // תמיד נכתוב סוג משתנה סטרינג אם השמצנה עצמו לא מחרוזתי נמיר אותו לסטרינג בתוך הסוגריים
        if (string.IsNullOrEmpty(inputMail) == false)
        {
            // קריאה לקוטרולר
            var login = await Http.GetAsync("api/Users/" + inputMail);

            if (login.IsSuccessStatusCode == true)
            {
                int userId = login.Content.ReadFromJsonAsync<int>().Result;
                // פנייה לעמוד גיימז שהכתובת שלו היא של המשתמש שהוזן
                nav.NavigateTo("./Games/" + userId);

                // אין צורך לשלוח הודעה כי המשתמש מופנה לדף
                //msg = "login worked";
            }

            else
            {
                msg = "login failed";
            }
        }

        else
        {
            msg = "יש להקליד כתובת מייל";
        }


    } }